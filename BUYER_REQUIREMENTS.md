# 구매자(Buyer) 모드 UI/UX 개선 기획

## 현재 상태 분석

### 구매자 사이드바 메뉴 (현재)
1. 내 발주 (`/buyer/rfqs`)
2. 새 발주 등록 (`/buyer/rfqs/new`)
3. 내 정보 (`/profile`)

### 구매자 주요 페이지
- `/buyer/rfqs` - 내 발주 목록
- `/buyer/rfqs/new` - 새 발주 등록
- `/buyer/rfqs/[id]` - 발주 상세 (받은 제안 목록)
- `/buyer/quotes` - 받은 제안 (전체)
- `/chat` - 채팅 목록
- `/chat/[roomId]` - 채팅방

---

## 개선 사항 목록

### P1: 핵심 개선

#### 1. 발주 등록 폼 간소화
**현재 필드:**
- 제목
- 설명
- 품목 목록 (복수, 품목명/수량/단위/희망가격 각각 입력)
- 구매희망가 (min/max)
- 납품일
- 배송주소

**개선안:**
- 제목 (필수)
- 상세요청 (필수) - 기존 설명+품목 통합, 자유 텍스트
- 참고사진첨부 (선택, 최대 5장)
- 평균 거래규모: 50만 미만 / 50~100만원 / 100~300만원 / 300만원 이상
- 발주주기: 비정기 / 주1회이상 / 주2~3회 / 월1~2회
- 납품희망일 (필수)
- 배송주소 (필수)

**효과:** 구매자가 쉽고 빠르게 발주 등록 가능

---

#### 2. 받은 제안 발주별 그룹화
**현재:** 모든 제안이 하나의 목록에 평면적으로 나열

**개선안:**
- 발주별로 그룹화하여 표시
- 각 발주 카드 아래에 해당 발주의 제안 목록 표시
- 제안 비교가 용이하도록 UI 구성

**구현 방식:**
```
[발주1: 삼겹살 100kg 납품 요청]
├── 제안1: A업체 - 30만원 (수락/거절 버튼)
├── 제안2: B업체 - 28만원 (수락/거절 버튼)
└── 제안3: C업체 - 32만원 (수락/거절 버튼)

[발주2: 한우 채끝 50kg]
├── 제안1: D업체 - 150만원
└── 제안2: E업체 - 145만원
```

---

#### 3. 발주 상세 페이지 (제안 목록) 레이아웃 개선
**현재:** 발주 정보 + 제안 목록이 위아래로 나열

**개선안:**
- 2단 레이아웃: 좌측(발주정보) / 우측(제안 목록)
- 또는 탭 구조: [발주정보] [받은제안(N)]
- 제안 카드에 핵심 정보만 표시:
  - 업체명
  - 제안금액 (강조)
  - 납품가능일
  - 제안설명 (접기/펼치기)
  - 첨부파일 (있으면)
  - 수락/거절 버튼

---

#### 4. 채팅 기능 개선
**현재 구현 완료:**
- 입금 확인 요청 (구매자 → 판매자)
- 입금 확인 완료 (판매자 → 구매자)
- 납품 완료 (판매자)

**추가 개선 필요:**
- 채팅방 상단에 거래 진행 상태 표시 (타임라인)
- 거래 확정 후 배송지 정보 표시
- 제안 금액 수정 요청/승인 기능 (P2)

---

### P2: 추가 개선

#### 5. 대시보드 통계 개선
**개선안:**
- 진행중인 발주 현황 요약
- 받은 제안 미확인 알림
- 최근 거래 내역

#### 6. 발주 목록 필터링
**개선안:**
- 상태별 필터: 전체 / 모집중 / 진행중 / 완료
- 기간별 필터: 최근 1주 / 1개월 / 3개월 / 전체

#### 7. 알림 시스템 강화
**알림 유형:**
- 새 제안 도착
- 제안 수락/거절 결과
- 입금 확인 완료
- 납품 완료
- 채팅방 만료 임박 (24시간 전)

---

## 데이터 모델 변경

### RFQ 모델 추가 필드 (이미 적용됨)
```prisma
model RFQ {
  // 기존 필드 유지

  // 신규 필드
  orderSizeRange    String?   @map("order_size_range")   // 평균 거래규모
  orderFrequency    String?   @map("order_frequency")    // 발주주기
  referenceImages   String[]  @map("reference_images")   // 참고사진 (Base64)
}
```

---

## 구현 우선순위

### 1단계: 폼 간소화
- [ ] `/buyer/rfqs/new` 페이지 재작성
- [ ] `/api/rfqs` POST API 신규 필드 처리

### 2단계: 제안 목록 개선
- [ ] `/buyer/quotes` 발주별 그룹화 구현
- [ ] `/buyer/rfqs/[id]` 레이아웃 개선

### 3단계: 채팅 및 알림
- [ ] 채팅방 거래 상태 타임라인 추가
- [ ] 알림 유형별 표시 개선

---

## 파일 변경 목록

| 파일 | 작업 |
|------|------|
| `/app/(dashboard)/buyer/rfqs/new/page.tsx` | 폼 전면 재작성 |
| `/app/(dashboard)/buyer/rfqs/page.tsx` | 필터링 추가 |
| `/app/(dashboard)/buyer/rfqs/[id]/page.tsx` | 레이아웃 개선 |
| `/app/(dashboard)/buyer/quotes/page.tsx` | 발주별 그룹화 |
| `/app/api/rfqs/route.ts` | 신규 필드 처리 |

---

## 참고: 판매자 모드 수정 완료 사항

1. ~~상단 3개 카드 제거~~ ✓
2. ~~안내문구 + 검색 한 줄 통합~~ ✓
3. ~~발주 목록 위로 이동~~ ✓
4. ~~평균발주금액/발주주기 라벨 명확화~~ ✓
5. ~~제안완료 발주는 버튼 비활성화~~ ✓
6. ~~무의미한 수량 정보 제거~~ ✓
7. ~~발주 상세 레이아웃 재배치~~ ✓
8. ~~현재 보유 크레딧 섹션 제거~~ ✓
9. ~~제안 폼 순서 변경 + 버튼 텍스트 수정~~ ✓
10. ~~보낸제안 메뉴 삭제~~ ✓
